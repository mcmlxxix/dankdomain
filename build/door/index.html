<!DOCTYPE html>
<html lang="en-US">
<head>
<title>Dank Domain: the return of Hack & Slash</title>
<style type='text/css'>
  body {
    background-color: #020410;
    color: antiquewhite;
  }
  #terminal-container {
    border: 0;
    top: 0; left: 0;
    width: 70%;
    height: 100%;
    position: fixed;
  }
  #Info {
    top: 0; right: 0;
    width: 30%;
    height: 100%;
    position: fixed;
  }
  a:link, a:visited {
    background-color: black;
    text-decoration: none;
    display: inline-block;
  }
  a:hover, a:active {
    background-color: #112266;
    color: #ace;
  }
</style>
<link rel="stylesheet" href="build/xterm.css" />
<link rel="stylesheet" href="build/addons/fullscreen/fullscreen.css" />

<script>
if (window.addEventListener) {
    window.addEventListener("message", receive, false);       
}
else {
    if (window.attachEvent) {
        window.attachEvent("onmessage", receive, false);
    }
}

function receive(event) {
  if (event.data) {
    switch(event.data.func) {
      case 'kb':
      case 'emit':
        if (!carrier) {
          endSession();
          newSession();
          return;
        }
        if (event.data.message) {
          socket.send(event.data.message);
          if (event.data.return)
            socket.send('\x0A');
        }
        else {
          if (event.data.return)
            socket.send('\x0D');
        }
        break;

    if (event.data.func === 'kb')
        term.focus();
    }
  }
}

function resize() {
  var stylesheet = document.styleSheets[0];
  for (var i in stylesheet.cssRules) {
    css = stylesheet.cssRules[i];
    if (css.selectorText === '#terminal-container')
      l = css;
    if (css.selectorText === '#Info')
      r = css;
  }

  Object.assign(l.style, { 'top':'1%', 'height':'97%', 'width':'70%' });
  Object.assign(r.style, { 'top':'0%', 'height':'100%', 'width':'30%' });
  term.setOption('fontSize', 16);
  while ((fontSize = term.getOption('fontSize')) > 7 && term.proposeGeometry().cols < 81)
    term.setOption('fontSize', --fontSize);

  w = 29;
  do {
    w = (parseInt(w) + 1) + '%';
    v = (100 - parseInt(w)) + '%';
    Object.assign(l.style, { 'top':'1%', 'height':'97%', 'width':v });
    Object.assign(r.style, { 'top':'0%', 'height':'100%', 'width':w });
    xy = term.proposeGeometry();
  } while (xy.cols > 81 && parseInt(w) < 44);

  while ((xy = term.proposeGeometry()).cols > 81)
    term.setOption('fontSize', ++fontSize);

  if (xy.col > 79)
    term.fit();
  else
    term.resize(80, xy.rows);
}
</script>
</head>
<body onload="resize();" onresize="resize();">
<div id="terminal-container"></div>
<iframe seamless id="Info" name="Info" src="./info.html"></iframe>
<div id="idle-container" hidden=true>
<h2>Dank Domain: the return of Hack &amp; Slash</h2>
<h3>&copy;2017 <a href="https://robert.hurst-ri.us">Robert Hurst</a></h3>
<h4>use REFRESH button to start over</h4>
<button onclick="window.location.reload();"> REFRESH </button> <button onclick="window.history.back();">Go Back</button>
<h4>The Olde Tavern's <a href="./today.txt" target="_blank">news</a>.</h5>
<hr>
<p>Works best using <a href="https://getfedora.org/" target="_blank">Linux</a>: either GnomeShell or Terminology.</p>
<p></p>Microsoft Edge, Google / Android Chrome, and Mozilla Firefox are known to work well with broadband &amp; wifi.<br>
Classic Microsoft Internet Explorer is not supported.</p>
<p><a href="https://youtu.be/3LLStpReMBc" target="_blank">Other users</a> who think differently will find that mileage varies here.</p>
Happy hunting!
</div>
<audio id="play">
    <source id="oggPlay" type="audio/ogg" />
    <source id="mp3Play" type="audio/mp3" />
</audio>
<audio id="tune">
  <source id="oggTune" type="audio/ogg" />
  <source id="mp3Tune" type="audio/mp3" />
</audio>
<script src="https://cdnjs.cloudflare.com/ajax/libs/es6-promise/4.1.1/es6-promise.auto.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fetch/1.0.0/fetch.min.js"></script>
<script src="build/xterm.js" ></script>
<script src="build/addons/attach/attach.js" ></script>
<script src="build/addons/fit/fit.js" ></script>
<script src="build/addons/fullscreen/fullscreen.js" ></script>
<script src="build/addons/search/search.js" ></script>
<script src="build/addons/winptyCompat/winptyCompat.js" ></script>
<script src="main.js"></script>
</body>
</html>