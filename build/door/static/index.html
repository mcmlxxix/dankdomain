<!DOCTYPE html>
<html lang="en-US">
<head>
<title>Dank Domain: the return of Hack & Slash</title>
<link rel="icon" href="favicon.ico" type="image/x-icon">
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<link rel="manifest" href="manifest.json">
<link rel="preload" href="vt220.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<meta charset="UTF-8">
<meta name="application-name" content="dankdomain">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="dankdomain">
<meta name="msapplication-starturl" content="http://play.ddgame.us/">
<meta name="theme-color" content="#102040"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=1.0, shrink-to-fit=yes, user-scalable=no">
<style type='text/css'>
  @font-face {
    font-family: 'tty';
    src: url('vt220.woff2') format('woff2'), url('vt220.woff') format('woff'), url('vt220.ttf') format('ttf');
  }
  body {
    background-color: #102040;
    color: antiquewhite;
    border: none;
    font-family: 'IBM Plex Mono', Consolas, monospace;
    margin: 0px;
    touch-action: none;
  }
  #terminal {
    font-family: 'IBM Plex Mono', Consolas, monospace;
    border: 0;
    top: 0; left: 0;
    width: 70%;
    height: 100%;
    position: fixed;
  }
  #Info {
    top: 0; right: 0;
    width: 30%;
    height: 100%;
    position: fixed;
  }
  a:link, a:visited {
    background-color: #0f1e3c;
    color: rosybrown;
    display: inline-block;
    font-family: 'Dancing Script', cursive;
    font-size: 125%;
    font-weight: bolder;
    text-decoration: none;
  }
  a:hover, a:active {
    background-color: #112244;
    color: aliceblue;
  }
  td img {
    display: block;
    margin-left: auto;
    margin-right: auto;
  }
  chromedash-toast {
    width: 100%;
    left: 0;
    right: 0;
  }
  #a2hs-button.disabled {
    opacity: 0.35;
  }
</style>
<link href="https://fonts.googleapis.com/css?family=Dancing+Script" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=IBM+Plex+Mono" rel="stylesheet">
<link rel="stylesheet" href="xterm.css">
</head>
<body>
<div id="terminal"></div>
<iframe seamless id="Info" name="Info" src="./info.html" style="border: none;" allow="autoplay"></iframe>
<div id="wall" hidden>
  <table style="margin: 0px auto; vertical-align: bottom; white-space: nowrap;">
    <tr>
      <td></td>
      <td style="text-align: center;"><h2>ðŸ¤´ <a href="https://DDgame.us"><span style="color:gray !important; font-size:larger">Dank Domain</span></a> ðŸ‘¸<br><span style="color:rosybrown !important; font-size:smaller">the return of Hack &amp; Slash</span></h2></td>
      <td><img src="images/castle.png" style="height: 96px; width: 96px;" title="Fortune & Glory"></td></tr>
    <tr>
      <td rowspan=4><img src="images/joust.png" style="height: 96px; width: 96px;" title="Player versus Player"></td>
      <td colspan=2>Press <button onclick="window.location.reload(true);"> REFRESH </button> to re-connect</td></tr>
    <tr>
      <td>Read today's <a href="today.txt" target="_blank">The Olde Tavern</a> news</td>
      <td hidden id="a2hs" style="text-align:center;"><a href="#" id="a2hs-button" title="Add app to homescreen"><img src="./a2hs.svg" style="float: right; height: 24px; width: 24px;"></a></td></tr>
    <tr>
      <td colspan=2>Watch an online player <select id="lurker-list"></select> auto-refreshes</td></tr>
    <tr>
      <td><hr></td>
      <td rowspan=2 style="vertical-align: middle;"><img src="images/dragon.jpg" style="height: 96px; width: 96px;" title="Classic gaming"></td></tr>
    <tr>
      <td><img src="images/chrome.png" style="height: 96px; width: 96px;">&nbsp;</td><td>Google <b>Chrome</b> for Android, mobile or desktop&nbsp;<br>can use <i><b>Add to Home Screen...</b></i> menu option<br>to play game as a fullscreen <b>app</b></td></tr>
    <tr id="desktop" hidden>
      <td></td><td>Microsoft <b>Edge</b> and Mozilla <b>Firefox</b> desktop <b>work</b><br>classic Microsoft <b>I</b>nternet <b>E</b>xplorer is <b>not supported</b></td></tr>
    <tr>
      <td colspan=3 style="text-align:right;">ðŸ‡ºðŸ‡¸ <span style="color:gray !important; font-size:smaller">&copy;2017-2019 <a href="https://robert.hurst-ri.us">Robert Hurst</a> ðŸ§™</span></td></tr>
  </table>
</div>
<audio id="play">
  <source id="oggPlay" type="audio/ogg" />
  <source id="mp3Play" type="audio/mp3" />
</audio>
<audio id="tune">
  <source id="oggTune" type="audio/ogg" />
  <source id="mp3Tune" type="audio/mp3" />
</audio>
<noscript>https://www.google.com/chrome/</noscript>
<script type="text/javascript">
  let a = document.querySelector("#a2hs-button");
  let t = void(0);

  if (! /MSIE \d|Trident.*rv:/.test(navigator.userAgent)) {
    document.getElementById('terminal').hidden = false;
    document.getElementById('Info').hidden = false;
    document.getElementById('wall').hidden = true;
    document.getElementById('desktop').hidden = true;

    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('sw.js').then(function(registration) {
          // Registration was successful
          console.log('ServiceWorker registration successful with scope: ', registration.scope);
        }, function(err) {
          // registration failed :(
          console.log('ServiceWorker registration failed: ', err);
        });
      });
    }

    window.addEventListener('beforeinstallprompt', (e) => {
      console.log('beforeinstallprompt', e);
      // Prevent Chrome 67 and earlier from automatically showing the prompt
      e.preventDefault();
      // Stash the event so it can be triggered later.
      t = e;
      // Update UI notify the user they can add to home screen
      document.getElementById("a2hs").hidden = false;

      a.classList.add("available");
    });

    a.addEventListener("click", function(e) {
      console.log('click', e);
      e.preventDefault();
      t && !a.classList.contains("disabled") && t.prompt().then(function() {
        t.userChoice.then(function(e) {
          console.log(e);
          "accepted"===e.outcome
            ? (a.classList.add("disabled"),a.setAttribute("title","App already installed."),t=null)
            : a.setAttribute("title","Refresh the page and click again to install app.");
          a.classList.add("disabled")
        })
      });
  });
  }
  else {
    document.getElementById('terminal').hidden = true;
    document.getElementById('Info').hidden = true;
    document.getElementById('wall').hidden = false;
    document.getElementById('desktop').hidden = false;
  }
</script>
<script src="bundle.js"></script>
</body>
</html>
