<!doctype html>
<html>
<head>
<title>Dank Domain: the return of Hack &amp; Slash</title>
<link href='http://fonts.googleapis.com/css?family=MedievalSharp' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="style.css">
</head>
<script src="socket.io/socket.io.js"></script>
<script src="term.js"></script>
<script src="options.js"></script>
<script src="tty.js"></script>
<script>
function runTerminal() {
  var link=document.getElementById('back');
  var button=document.getElementById('open');
  if (link.hidden) {
    link.hidden = false;
    button.click();
  }
  rotateImage();
}
/*artwork.onload = function () {

    /// set size proportional to image
    canvas.height = canvas.width * (artwor.height / artwork.width);

    /// step 1 - resize to 50%
    var oc = document.createElement('canvas'),
        octx = oc.getContext('2d');

    oc.width = artwork.width * 0.5;
    oc.height = artwork.height * 0.5;
    octx.drawImage(artwork, 0, 0, oc.width, oc.height);

    /// step 2 - resize 50% of step 1
    octx.drawImage(oc, 0, 0, oc.width * 0.5, oc.height * 0.5);

    /// step 3, resize to final size
    ctx.drawImage(oc, 0, 0, oc.width * 0.5, oc.height * 0.5,
    0, 0, canvas.width, canvas.height);
}
*/
function rotateImage() {
  var images = [
    'arexielite_by_peachyco.png',
    'dragonborn_dagger_sorcerer_by_peachyco.png',
    'dragonborn_hexblade_by_peachyco.png',
    'elf_cleric_by_peachyco.png',
    'elf_fighter_by_peachyco.png',
    'guild_findsman_by_peachyco.png',
    'human_battlemage_by_peachyco.png',
    'human_enchantress_mage_by_peachyco.png',
    'human_warpriest_by_peachyco.png',
    'human_wizard_by_peachyco.png',
    'kashaw_and_zahra_by_peachyco.png',
    'krauser_dragonborn_warlord_by_peachyco.png',
    'lucien2_human_wizard_by_peachyco.png',
    'lucien_human_wizard_by_peachyco.png',
    'orc_pirate_by_peachyco.png',
    'paladin_by_peachyco.png',
    'sketch_dragonborn_hexblade_by_peachyco.png',
    'thrask_goliath_fighter_by_peachyco.png',
    'warforged_fighter_and_human_wizard_by_peachyco.png',
    'yuriel_genasi_warlord_by_peachyco.png'
 ];

  var artwork = document.getElementById('artwork');
  var n = Math.trunc(Math.random() * images.length);
  artwork.src = 'images/' + images[n];
}
var t = setInterval(rotateImage, 60000);
/**
 * Writes an image into a canvas taking into
 * account the backing store pixel ratio and
 * the device pixel ratio.
 *
 * @author Paul Lewis
 * @param {Object} opts The params for drawing an image to the canvas
 */
function drawImage(opts) {

    if(!opts.canvas) {
        throw("A canvas is required");
    }
    if(!opts.image) {
        throw("Image is required");
    }

    // get the canvas and context
    var canvas = opts.canvas,
        context = canvas.getContext('2d'),
        image = opts.image,

    // now default all the dimension info
        srcx = opts.srcx || 0,
        srcy = opts.srcy || 0,
        srcw = opts.srcw || image.naturalWidth,
        srch = opts.srch || image.naturalHeight,
        desx = opts.desx || srcx,
        desy = opts.desy || srcy,
        desw = opts.desw || srcw,
        desh = opts.desh || srch,
        auto = opts.auto,

    // finally query the various pixel ratios
        devicePixelRatio = window.devicePixelRatio || 1,
        backingStoreRatio = context.webkitBackingStorePixelRatio ||
                            context.mozBackingStorePixelRatio ||
                            context.msBackingStorePixelRatio ||
                            context.oBackingStorePixelRatio ||
                            context.backingStorePixelRatio || 1,

        ratio = devicePixelRatio / backingStoreRatio;

    // ensure we have a value set for auto.
    // If auto is set to false then we
    // will simply not upscale the canvas
    // and the default behaviour will be maintained
    if (typeof auto === 'undefined') {
        auto = true;
    }

    // upscale the canvas if the two ratios don't match
    if (auto && devicePixelRatio !== backingStoreRatio) {

        var oldWidth = canvas.width;
        var oldHeight = canvas.height;

        canvas.width = oldWidth * ratio;
        canvas.height = oldHeight * ratio;

        canvas.style.width = oldWidth + 'px';
        canvas.style.height = oldHeight + 'px';

        // now scale the context to counter
        // the fact that we've manually scaled
        // our canvas element
        context.scale(ratio, ratio);

    }

    context.drawImage(pic, srcx, srcy, srcw, srch, desx, desy, desw, desh);
}
</script>
<body onload="setTimeout(runTerminal, 250);">
<img id="artwork" src="../images/" align="left" height="50%" width="50%">
<a id="back" href="https://robert.hurst-ri.us/games/dankdomain/" hidden>Go back</a>&nbsp;
<button id="open">PLAY!</button>
<p>double-click title bar to maximize window</p>
<p>ctrl-Z anytime to logoff</p>
<p>Node.js serving <a href="https://github.com/chjj/tty.js" target="_blank">tty.js</a> using <a href="https://github.com/chjj/term.js" target="_blank">term.js</a></p>
<audio autoplay>
  <source src="dankdomain.wav" type="audio/wav">
  Welcome to my domain
</audio>
</body>
</html>
