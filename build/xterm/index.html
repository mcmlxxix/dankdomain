<!DOCTYPE html>
<html lang="en-US">
<head>
<title>Dank Domain: the return of Hack & Slash</title>
<style>
  body {
    background-color: midnightblue;
    color: antiquewhite;
  }
  #terminal {
    border: 0;
    top: 0; left: 0;
    width: 80%;
    height: 100%;
    position: fixed;
  }
  #Info {
    top: 0; right: 0;
    width: 20%;
    height: 100%;
    position: fixed;
  }
</style>
<link rel="stylesheet" href="xterm.css">
<script>
if (window.addEventListener) {
    window.addEventListener("message", receive, false);       
}
else {
    if (window.attachEvent) {
        window.attachEvent("onmessage", receive, false);
    }
}

function receive(event) {
  if (event.data) {
    switch(event.data.func) {
      case 'kb':
      case 'emit':
      if (!carrier) newSession();
        if (event.data.message) {
          socket.emit('data', termid, event.data.message);
          if (event.data.return)
            socket.emit('data', termid, '\x0A');
        }
        else {
          if (event.data.return)
            socket.emit('data', termid, '\x0D');
        }
        break;

    if (event.data.func === 'kb')
        term.focus();
    }
  }
}

function resize() {
  term.fit();

  var stylesheet = document.styleSheets[0];
  for (var i in stylesheet.cssRules) {
    css = stylesheet.cssRules[i];
    if (css.selectorText === '#terminal')
      l = css;
    if (css.selectorText === '#Info')
      r = css;
  }

  w = 20;
  do {
    w = (parseInt(w) + 2) + '%';
    v = (100 - parseInt(w)) + '%';
    Object.assign(l.style, { 'top':'0%', 'height':'100%', 'width':v });
    Object.assign(r.style, { 'top':'0%', 'height':'100%', 'width':w });
    term.fit();
  } while(term.cols > 90 && parseInt(w) < 40);
 }
</script>
</head>
<body onload="resize();" onresize="resize();">
<div id="terminal"></div>
<iframe seamless id="Info" name="Info" src="./info.html"></iframe>
<h2>Dank Domain: the return of Hack &amp; Slash</h2>
<h3>&copy;2017 Robert Hurst</h3>
<h4>use REFRESH button to start over</h4>
<input type="button" value="REFRESH" onclick="window.location.reload();" />
<h4>The Olde Tavern's <a href="./today.txt" target="_blank">news</a>.</h5>
<hr>
Microsoft Edge, Google / Android Chrome, and Mozilla Firefox are successfully tested.<br>
Legacy Microsoft Internet Explorer is not supported.<br>
Other users, such as <a href="https://youtu.be/3LLStpReMBc" target="_blank">Apple IoS</a>, may find their mileage will vary here.
<audio id="play">
    <source id="oggPlay" type="audio/ogg" />
    <source id="mp3Play" type="audio/mp3" />
</audio>
<audio id="tune">
  <source id="oggTune" type="audio/ogg" />
  <source id="mp3Tune" type="audio/mp3" />
</audio>
<script src="socket.io/socket.io.js"></script>
<script src="xterm/dist/xterm.js"></script>
<script src="xterm/dist/addons/fit/fit.js"></script>
<script src="main.js"></script>
</body>
</html>